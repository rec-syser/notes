# JAVA 并发编程

## 基础知识

### 缓存一致性协议

![image-20200901153542437](java_concurrency.assets/image-20200901153542437.png)

![image-20200901155550739](java_concurrency.assets/image-20200901155550739.png)

1. 如果两个cpu同时对缓存中相同的数据进行了操作，并且想要保存到主存中，这样在一个指令周期内会对两个cpu的指令进行裁决，决定执行那个cpu的指令并保存相应数据。
2. 缓存行：CPU缓存的最小存储单元
3. 机械硬盘的最小存储单元：簇
4. 总线锁和缓存一致性是锁的粒度不同
5. 什么情况下缓存一致性协议会失效：
   1. 缓存行失效：存储变量的存储长度大于缓存行的长度。这时候只能加总线锁
   2. CPU本身不支持缓存一致性协议

### JAVA线程

1. 进程是系统分配资源的基本单位，线程是cpu调度的基本单位
2. 使用用户级线程可以避免过度创建线程
3. 用户级线程和内核级线程的理解：https://juejin.im/post/6844903962504593421 

### JMM java 内存模型  --- java 线程内存模型

#### 问题

1. 既然CPU有MESI缓存一致性协议，为什么JMM还需要volatile 关键字？https://juejin.im/post/6847902216255356936 没有详细看完